(function(N,r,U,s,V,p,e,y,R){"use strict";var I;const{Image:K}=y.General,{FormRow:j}=y.Forms,M=(I=vendetta.metro.findByProps("ActionSheetRow"))===null||I===void 0?void 0:I.ActionSheetRow;function z(l){let{label:n,icon:o,onPress:h,onLongPress:t}=l;const d=e.stylesheet.createThemedStyleSheet({icon:{width:18,height:18,tintColor:R.semanticColors.INTERACTIVE_NORMAL,opacity:1}});return M?React.createElement(M,{label:n,icon:React.createElement(M.Icon,{source:o,IconComponent:function(){return React.createElement(K,{resizeMode:"cover",style:d.icon,source:o})}}),onPress:function(){return h?.()},onLongPress:function(){return t?.()}}):React.createElement(j,{label:n,leading:React.createElement(j.Icon,{source:o,style:d.icon}),onPress:function(){return h?.()},onLongPress:function(){return t?.()}})}var T,w,x,L,F;const{View:c,Text:J,TextInput:X,TouchableOpacity:E}=y.General,{FormIcon:A}=y.Forms,{ScrollView:W,Image:Z,Modal:q}=e.ReactNative,Q=r.findByProps("pushModal"),_=r.findByStoreName("ThemeStore"),C=((T=r.find(function(l){var n,o;return(o=l.default)===null||o===void 0||(n=o.internal)===null||n===void 0?void 0:n.resolveSemanticColor}))===null||T===void 0?void 0:T.default.internal.resolveSemanticColor)??((w=r.find(function(l){var n;return(n=l.meta)===null||n===void 0?void 0:n.resolveSemanticColor}))===null||w===void 0?void 0:w.meta.resolveSemanticColor)??function(){},ee=r.findByName("Navigator")??((x=r.findByProps("Navigator"))===null||x===void 0?void 0:x.Navigator),te=((L=r.findByProps("getRenderCloseButton"))===null||L===void 0?void 0:L.getRenderCloseButton)??((F=r.findByProps("getHeaderCloseButton"))===null||F===void 0?void 0:F.getHeaderCloseButton),ne=r.findByName("Svg",!1).default,k=r.findByName("Svg",!1).Path,ae=r.findByProps("useSafeAreaInsets");function re(l,n){return function(){return e.React.createElement(E,{onPress:l,onLongPress:n},e.React.createElement(A,{source:s.getAssetIDByName("ic_edit_24px"),style:{marginRight:8,marginLeft:-8,opacity:1}}))}}function $(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"unknown",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"dummy",o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"dummy",h=arguments.length>3?arguments[3]:void 0,t=arguments.length>4?arguments[4]:void 0;return function(){const[d,O]=e.React.useState(!0),[H,P]=e.React.useState(`${n}`),a={header:C(_.theme,R.semanticColors.HEADER_PRIMARY),test:C(_.theme,R.semanticColors.TEXT_MUTED),bgDark:C(_.theme,R.semanticColors.BACKGROUND_SECONDARY_ALT),bgBright:C(_.theme,R.semanticColors.BACKGROUND_SECONDARY),bgBrighter:C(_.theme,R.semanticColors.BACKGROUND_ACCENT)},u=e.React.createElement(ne,{height:"24",width:"24",viewBox:"0 0 24 24",fill:d?a.header:a.test},e.React.createElement(k,{d:"M2.75 5C2.33579 5 2 5.33579 2 5.75C2 6.16421 2.33579 6.5 2.75 6.5H21.25C21.6642 6.5 22 6.16421 22 5.75C22 5.33579 21.6642 5 21.25 5H2.75Z"}),e.React.createElement(k,{d:"M2.75 11.5C2.33579 11.5 2 11.8358 2 12.25C2 12.6642 2.33579 13 2.75 13H19C20.3807 13 21.5 14.1193 21.5 15.5C21.5 16.8807 20.3807 18 19 18H14.5607L15.2803 17.2803C15.5732 16.9874 15.5732 16.5126 15.2803 16.2197C14.9874 15.9268 14.5126 15.9268 14.2197 16.2197L12.2197 18.2197C11.9268 18.5126 11.9268 18.9874 12.2197 19.2803L14.2197 21.2803C14.5126 21.5732 14.9874 21.5732 15.2803 21.2803C15.5732 20.9874 15.5732 20.5126 15.2803 20.2197L14.5607 19.5H19C21.2091 19.5 23 17.7091 23 15.5C23 13.2909 21.2091 11.5 19 11.5H2.75Z"}),e.React.createElement(k,{d:"M2 18.75C2 18.3358 2.33579 18 2.75 18H9.25C9.66421 18 10 18.3358 10 18.75C10 19.1642 9.66421 19.5 9.25 19.5H2.75C2.33579 19.5 2 19.1642 2 18.75Z"})),[f,i]=e.React.useState(!1),b=e.React.useRef(null),B=ae.useSafeAreaInsets();let m=e.React.createElement(c,{style:{marginTop:0}},e.React.createElement(c,{style:{padding:15,paddingBottom:0,display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between"}},e.React.createElement(c,{style:{display:"flex",flexDirection:"row",gap:8}},e.React.createElement(E,{onPress:function(){O(!d)},onLongPress:function(){p.showToast("Toggle Word Wrap",s.getAssetIDByName("ic_information_filled_24px"))},style:{backgroundColor:d?a.bgBrighter:a.bgDark,padding:4,borderRadius:5,borderWidth:2,borderColor:d?a.bgBright:a.bgDark}},u),e.React.createElement(E,{onPress:function(){i(!0)},onLongPress:function(){p.showToast(e.i18n.Messages.JUMP,s.getAssetIDByName("ic_information_filled_24px"))},style:{marginLeft:10,backgroundColor:a.bgDark,padding:4,borderRadius:5,borderWidth:2,borderColor:a.bgDark}},e.React.createElement(Z,{source:s.getAssetIDByName("ic_reply_24px"),style:{height:24,width:24,transform:[{scaleX:-1},{rotate:"-90deg"}]}})))),e.React.createElement(W,{ref:b,style:{margin:15,marginBottom:50+B.bottom}},e.React.createElement(W,{horizontal:!d},e.React.createElement(c,{style:{flexDirection:"row"}},e.React.createElement(c,{style:{borderTopLeftRadius:4,borderBottomLeftRadius:4,backgroundColor:a.bgDark,marginRight:5,paddingRight:2,paddingLeft:2,alignSelf:"flex-start"}}),e.React.createElement(X,{multiline:!0,selectable:!0,editable:t,style:[{color:a.header,lineHeight:20,flex:1}],onChangeText:function(g){P(`${g}`)}},H)))),e.React.createElement(q,{transparent:!0,animationType:"none",visible:f,onRequestClose:function(){return i(!1)}},e.React.createElement(c,{style:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"}},e.React.createElement(c,{style:{backgroundColor:a.bgBright,padding:20,borderRadius:10,width:"90%"}},e.React.createElement(c,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15}},e.React.createElement(y.Forms.FormText,{style:{fontSize:20,fontFamily:e.constants.Fonts.PRIMARY_BOLD}},e.i18n.Messages.JUMP),e.React.createElement(E,{onPress:function(){return i(!1)}},e.React.createElement(A,{source:s.getAssetIDByName("ic_close_16px"),style:{opacity:1}}))),e.React.createElement(E,{style:{backgroundColor:a.bgDark,borderRadius:5,padding:10,marginBottom:15,marginTop:5,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},onPress:function(){var g;let v=b?.current;i(!1),v==null||(g=v.scrollToEnd)===null||g===void 0||g.call(v,{animated:!0})}},e.React.createElement(A,{source:s.getAssetIDByName("ic_jump_to_bottom_24px"),style:{opacity:1}}),e.React.createElement(y.Forms.FormText,{style:{color:a.test,fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_BOLD,textTransform:"uppercase"}},"Jump to the bottom"),e.React.createElement(c,null)),e.React.createElement(E,{style:{backgroundColor:a.bgDark,borderRadius:5,padding:10,marginBottom:10,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},onPress:function(){var g;let v=b?.current;i(!1),v==null||(g=v.scrollTo)===null||g===void 0||g.call(v,{y:0,animated:!0})}},e.React.createElement(A,{source:s.getAssetIDByName("ic_jump_to_bottom_24px"),style:{opacity:1,transform:[{scaleY:-1}]}}),e.React.createElement(y.Forms.FormText,{style:{color:a.test,fontSize:16,fontFamily:e.constants.Fonts.PRIMARY_BOLD,textTransform:"uppercase"}},"Jump to the top"),e.React.createElement(c,null))))));return e.React.createElement(ee,{initialRouteName:"FILE_CONTENT_PREVIEW",screens:{FILE_CONTENT_PREVIEW:{headerLeft:te(function(){return Q.popModal("file-content-preview")}),headerRight:re(function(){return h(`${H}`)}),render:function(){return m},headerTitle:function(){let g=C(_.theme,R.semanticColors.HEADER_PRIMARY);return e.React.createElement(E,{onPress:function(){e.clipboard.setString(l),p.showToast(e.i18n.Messages.COPIED_TEXT,s.getAssetIDByName("toast_copy_message"))}},e.React.createElement(c,{style:{alignSelf:"flex-start",maxWidth:"80%",minWidth:"80%"}},e.React.createElement(J,{ellipsizeMode:"tail",numberOfLines:1,style:{color:g,textAlign:"left"}},l)),e.React.createElement(c,{style:{alignSelf:"flex-start"}},e.React.createElement(J,{ellipsizeMode:"tail",style:{color:g,fontSize:12,textAlign:"left"}},o)))}}}})}}const G=r.findByProps("getChannel","getDMFromUserId");r.findByStoreName("MessageStore"),r.findByStoreName("SelectedChannelStore"),r.findByProps("MessagesHandlers");const S=r.findByProps("openLazy","hideActionSheet"),D=r.findByProps("pushModal");function ie(l){const n=JSON.parse(JSON.stringify(l));for(const o in n.author)switch(o){case"email":case"phone":case"mfaEnabled":case"hasBouncedEmail":delete n.author[o]}return Object.fromEntries(Object.entries(n).sort(function(o,h){let[t]=o,[d]=h;return t.localeCompare(d)}))}function le(){U.before("openLazy",S,function(l){const[n,o,h]=l,t=h?.message;o!=="MessageLongPressActionSheet"||!t||n.then(function(d){const O=U.after("default",d,function(H,P){e.React.useEffect(function(){return function(){return O()}},[]);const a=V.findInReactTree(P,function(u){var f,i;return(u==null||(i=u[0])===null||i===void 0||(f=i.type)===null||f===void 0?void 0:f.name)==="ButtonRow"});if(!a)return P;a.push(e.React.createElement(z,{label:"Edit Message Locally",icon:s.getAssetIDByName("ic_chat_bubble_32px"),onPress:async function(){var u;D.pushModal({key:"file-content-preview",modal:{key:"file-content-preview",modal:$(t.content&&t.content.trim()!==""?t.content.replace(/\n/g," "):"[Attachment(s)]",t.content&&t.content.trim()!==""?t.content:"\uFEFF ",`@${t==null||(u=t.author)===null||u===void 0?void 0:u.username}`,function(f){var i;e.FluxDispatcher.dispatch({type:"MESSAGE_UPDATE",message:{...t,content:`${f}`,guild_id:(i=G.getChannel(t?.channel_id))===null||i===void 0?void 0:i.guild_id},dont_log:!0}),p.showToast("Pushed Edit",s.getAssetIDByName("ic_edit_24px")),D.popModal("file-content-preview")}),animation:"slide-up",shouldPersistUnderModals:!1,closable:!0}}),S.hideActionSheet()},onLongPress:async function(){var u,f,i;D.pushModal({key:"file-content-preview",modal:{key:"file-content-preview",modal:$(t.content&&t.content!=""?t?.content.length>32?(t==null||(f=t.content)===null||f===void 0||(u=f.slice(0,32))===null||u===void 0?void 0:u.replace(/\n/g," "))+"...":t?.content:"[Attachment(s)]",JSON.stringify(ie(t),null,"	"),`@${t==null||(i=t.author)===null||i===void 0?void 0:i.username}`,function(b){try{var B;let m={type:"MESSAGE_UPDATE",message:{...JSON.parse(b),guild_id:(B=G.getChannel(t?.channel_id))===null||B===void 0?void 0:B.guild_id},dont_log:!0};(!m.message.content||m.message.content.replace(/\ufeff/g,"")==="")&&delete m.message.content,e.FluxDispatcher.dispatch(m),p.showToast("Pushed Edit",s.getAssetIDByName("ic_edit_24px")),D.popModal("file-content-preview")}catch{p.showToast("Make sure the JSON is valid",s.getAssetIDByName("ic_warning_24px"))}}),animation:"slide-up",shouldPersistUnderModals:!1,closable:!0}}),S.hideActionSheet()}})),t?.monke_msg_logger_deleted||a.push(e.React.createElement(z,{label:"Hide Message Locally",icon:s.getAssetIDByName("ic_eye"),onPress:async function(){e.FluxDispatcher.dispatch({type:"MESSAGE_DELETE",id:t.id,channelId:t.channel_id,__vml_cleanup:!0}),p.showToast("Hidden Message",s.getAssetIDByName("ic_eye_hidden")),S.hideActionSheet()}}))})})})}let Y=[];var oe={onLoad:function(){Y.push(le())},onUnload:function(){for(const l of Y)l()}};return N.default=oe,Object.defineProperty(N,"__esModule",{value:!0}),N})({},vendetta.metro,vendetta.patcher,vendetta.ui.assets,vendetta.utils,vendetta.ui.toasts,vendetta.metro.common,vendetta.ui.components,vendetta.ui);
